# 0.82.0-RC release notes

**Release date:** 2024-08-20

!!! warning "Release candidate notes"

    Welcome to the **release candidate (RC)** of DOSBox Staging 0.82.0!

    What is a ‚Äúrelease candidate‚Äù? You can think of it as a ‚Äúsneak preview‚Äù of
    our upcoming release before we complete our full round of internal
    testing. As such, it might contain occasional bugs or regressions, but it
    should be free of major problems.

    Community feedback is crucial to discover issues in any complex
    software. The release candidate is intended for experienced early adopters
    willing to help us stabilise DOSBox Staging for the final release. If you‚Äôve
    found any issue in the RC, please [report it to us!](../../get-involved/index.md#report-an-issue)

    Regular users who prefer a straight-line progression from one release to
    the next should wait for the stable release; this should come up to 2
    months after the release candidate.


## Summary

- ESFM emulation
- MMX emulation
- experimental arm64
- XBR upscaler


## How to upgrade

Start by downloading the latest version, then make sure to upgrade your
primary configuration as described below.

### Downloads

<div class="compact" markdown>

- [Windows](../windows.md)
- [macOS](../macos.md)
- [Linux](../linux.md)

</div>


### Upgrading your primary configuration

Since config settings might be renamed, altered, or deprecated between
releases, it's best to let DOSBox Staging write the new default primary config
on the first launch, then reapply your old settings manually.

Start by backing up your existing primary config. This is where to find
it on each platform:

<div class="compact" markdown>

| <!-- --> | <!-- -->
|----------|----------
| **Windows**  | `C:\Users\%USERNAME%\AppData\Local\DOSBox\dosbox-staging.conf`
| **macOS**    | `~/Library/Preferences/DOSBox/dosbox-staging.conf`
| **Linux**    | `~/.config/dosbox/dosbox-staging.conf`

</div>

You can also execute DOSBox Staging with the `--printconf` option to have the
location of the primary config printed to your console.

After backing up the existing primary config, simply start the new version---a
new `dosbox-staging.conf` will be written containing the new defaults and
updated setting descriptions.

!!! note "Portable mode notes"

    In portable mode, `dosbox-staging.conf` resides in the same folder as your
    DOSBox Staging executable. The migration steps for portable mode users are
    as follows:

      - Unpack the new version into a _new_ folder (this is important).
      - Create a new _empty_ `dosbox-staging.conf` file in the new folder to
        enable portable mode.
      - Launch the new version.

    DOSBox Staging will write the new defaults to the empty
    `dosbox-staging.conf` file. After this, you carry over your settings from
    the old primary config manually.

### After upgrading

Look out for deprecation warnings in the logs (in yellow/orange colour) and
update your configs accordingly.


## Game compatibility improvements


??? note Full PR list of game compatibility improvements

    - Add carry, sign, zero, and parity flags to integer division instructions (#3785)
    - Clean up some leaked file handles (#3673)
    - Fix decrementing of MPU-401 track and conductor counters (#3766)
    - Fix file open error in ISO Drive (#3804)
    - Fix programmatic toggling of the Sound Blaster Pro 2 output filter (#3815)
    - Fix regression in Voodoo 16-bit memory write (#3841)
    - Fix the GUS reset register's startup behavior (#3755)
    - Implement File Locking (#3687)
    - Import missing S3 Trio64 XGA compare and fill routines from DOSBox-X (#3775)
    - Initialise the OPL operators per the AdLib v1.51 driver (#3772)
    - Integrate MMX emulation (#3426)
    - Move System File Table memory location (#3680)
    - Use inline memory routines for MMX (#3847)
    - Use linear 128 KB video memory pages for VESA modes (#3767)
    - Various MT-32 improvements & fix Bumpy's Arcade Fantasy intro tune (#3729)


## Graphics

- nearest
- XBR
- Voodoo fix
- S3 Trio64 XGA
- remove openglnb
- 128 kb linear vesa


??? note "Full PR list of graphics-related changes"

    - Add `use_nearest_texture_filter` shader pragma and `nearest` shader (#3852)
    - Check if hardware cursor is actually being enabled or disabled before setting VGA_LineDraw (#3725)
    - Fix assert failure from incorrectly mapping result of SDL_GL_SwapInterval() (#3844)
    - Fix regression in Voodoo 16-bit memory write (#3841)
    - Import missing S3 Trio64 XGA compare and fill routines from DOSBox-X (#3775)
    - Kill `openglnb` with fire üî•üî•üî•üî•üî• (#3672)
    - Minor `vga_draw.cpp` refactor (#3734)
    - Presentation mode, host rate & vsync cleanup (#3824)
    - Use linear 128 KB video memory pages for VESA modes (#3767)


## Sound

- 8000 to 96khz support
- ESFM
- DC bias remove
- Decouple CMS and OPL
- SB 2 output filter
- MPU-401 fix?
- GUS?
- Adlib compatiblility
- impulse pc speaker is the default
- MT-32 improvements

<div class="compact" markdown>

| Game                                          | Audio example                                                                                                                 |
| --------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------- |
| Quest for Glory: So You Want to Be a Hero   | <audio controls src="https://archive.org/download/dosbox-staging-v0.81.0-imfc/imfc-quest-for-glory.mp3"> Your browser does not support the <code>audio</code> element.</audio>   |
| The Colonel's Bequest -- Intro 1   | <audio controls src="https://archive.org/download/dosbox-staging-v0.81.0-imfc/imfc-colonels-bequest-1.mp3"> Your browser does not support the <code>audio</code> element.</audio>   |
| The Colonel's Bequest -- Intro 2   | <audio controls src="https://archive.org/download/dosbox-staging-v0.81.0-imfc/imfc-colonels-bequest-2.mp3"> Your browser does not support the <code>audio</code> element.</audio>   |
| The Colonel's Bequest -- Intro 3   | <audio controls src="https://archive.org/download/dosbox-staging-v0.81.0-imfc/imfc-colonels-bequest-3.mp3"> Your browser does not support the <code>audio</code> element.</audio>   |

</div>

??? note "Full PR list of sound-related changes"

    - Add a simple DC bias remover for the OPL output (#3310)
    - Add support for ESS mixer registers (#3702)
    - Decouple CMS and OPL emulations (#3559)
    - ESFM emulation (#3614)
    - Fix CD audio support on physical USB drives on Windows (#3840)
    - Fix ESS mixer volume handling (#3705)
    - Fix Ring Buffer PrevIndex() wrapping behavior for non power of 2 size (#3813)
    - Fix Sound Blaster programmatic low-pass filter toggling behaviour (#3712)
    - Fix decrementing of MPU-401 track and conductor counters (#3766)
    - Fix programmatic toggling of the Sound Blaster Pro 2 output filter (#3815)
    - Fix the GUS reset register's startup behavior (#3755)
    - Further mixer fixes and improvements mega PR #2 (#3756)
    - Improve `sbtype` and `oplmode` descriptions & clean up `sblaster.cpp` (#3566)
    - Initialise the OPL operators per the AdLib v1.51 driver (#3772)
    - Make the `impulse` PC speaker model the default (#3851)
    - Map 'Capture MIDI action' to Ctrl+Alt+F6 (Cmd+Opt+F6) by default (#3714)
    - Mirror the Adlib command port (388h) in the GUS (#3763)
    - Rework physical CDROM interface (#3591)
    - Show the mixer who's boss üòé (#3650)
    - Sync Nuked-OPL3 with upstream (#3818)
    - Various MT-32 improvements & fix Bumpy's Arcade Fantasy intro tune (#3729)



## Input


??? note "Full PR list of input-related changes"

    - Fix hang on exit after pressing the pause key (#3671)
    - Replace Ultima VIII keyboard hack with a proper solution (#3784)



## DOS integration

- MODE command
- File locking win 3.11


??? note "Full PR list of DOS integration related changes"

    - Add MODE command & various text mode improvements (#3741)
    - Allow loadfix to execute batch files (#3657)
    - Clean up some leaked file handles (#3673)
    - Do not hard exit when running `SET /P` (#3789)
    - Fix Windows 3.1 regression from SFT change (#3744)
    - Fix broken shell_history_file config option (std::weak_ptr version) (#3664)
    - Fix improper handling of some characters in shell history (#3791)
    - Fix shell history creation regression (#3485)
    - Implement File Locking (#3687)
    - Improve redirection handling in the DOS shell (#3838)
    - Keep file handle instead of entry in FileReader (#3528)
    - `MODE` command fixes & improvements (#3853)
    - Move System File Table memory location (#3680)
    - Move environment functions to psp (+ other small changes) (#3093)
    - Replace use of `stat` in imgmount (#3465)
    - The great DOS_File/DOS_Drive Refactor (plus some timestamp improvements) (#3786)
    - Use native file I/O in local and overlay drive (#3765)
    - Use wrapping behavior on localFile seek position (#3779)


## General

### Simplified CPU cycles settings

The `cycles` setting has been a source of a lot of confusion, so we replaced it with a much simpler way to configure the emulated CPU speed (believe it or not, there are over 20 valid `cycles` value permutations!)

The new streamlined CPU cycles settings are as follows:

- `cpu_cycles` ‚Äî Global or real mode only cycles setting.
- `cpu_cycles_protected` ‚Äî Optional protected mode only cycles setting.
- `cpu_throttle` ‚Äî Whether the CPU emulation should be dynamically throttled if your host CPU cannot keep up.

Please refer to the settings' descriptions to learn more (e.g., run `config -h cpu_cycles | more` from the DOS prompt).

Here are a few concrete examples:

#### Set fixed speed globally

This will roughly emulate the speed of the venerable i486DX2-66 in both real and protected mode. `cpu_cycles_protected = auto` means `cpu_cycles` controls the emulated CPU speed globally, both for real and protected mode.

```ini
[cpu]
cpu_cycles = 25000
cpu_cycles_protected = auto
```

####  Different real and protected mode speeds with throttling

20k cycles for real mode programs, and 400k for protected mode. Throttling is enabled, so if your host machine can't keep up, the actual number of emulated CPU cycles per millisecond will be dynamically lowered.

```ini
[cpu]
cpu_cycles = 20000
cpu_cycles_protected = 400000
cpu_throttle = on
```

#### Max speed

This will make the CPU emulation run as fast as your computer can handle it. Pretty useful when compiling programs, rendering 3D images, or playing late '90s 3D games in high SVGA/VESA resolutions (as long as they can run glitch-free on very fast CPUs).

```ini
[cpu]
cpu_cycles = max
cpu_cycles_protected = max
```

> **Notes**
> The legacy `cycles` setting is still available for backward compatibility with existing configs. When `cycles` is set, the new CPU settings are simply ignored. Do note, however, that we will remove support for `cycles` in the future; please start migrating your configs to the new settings now.


### Revised CPU cycles defaults

> **TL;DR**
> The default emulated CPU speed (cycles) setting for protected mode programs has been changed from "max" to 60,000 cycles.  The real mode default of 3000 cycles is unchanged. Read on to get the details! 

> **Note**
> When "legacy cycles mode" is enabled by setting `cycles` to a valid value, the old defaults are applied (3000 for real mode, and "max cycles" for protected mode). 

DOSBox traditionally defaulted to 3000 cycles for real mode programs, and "max cycles" (as fast as your host CPU can go) for protected mode programs. 3000 cycles for real mode is a good middle-of-the-road setting that gets most games running (even if it not optimally). The "max cycles" setting, on the other hand, is quite problematic for a couple of reasons:

- A significant number of games crash, misbehave, or manifest subtle bugs when the emulated CPU is "too fast". In the early days of DOSBox, `cycles = max` was not a problem because the much slower host CPUs from 10-20 years ago acted as a "natural throttle" on the effective emulation speed. However, many of those old speed-sensitive games that used to work with `cycles = max` are now broken on today's fast CPUs.

- The `max` setting is not transferable across setups as it depends on the host CPU's speed. Games configured for `cycles = max` might work fine on _your_ particular machine, but they could break on your friend's faster computer, or on yours a few years later when you get your long-awaited CPU upgrade. `max N%` cycles settings (e.g., `max 70%`) are plagued by the same problem.
  
- `cycles = max` often causes audio glitches and drop-outs in games. It's best to use the _lowest fixed cycles value_ that runs the game at an acceptable speed (read more tips about that [here](https://dosbox-staging.github.io/getting-started/beneath-a-steel-sky/#adjusting-the-emulated-cpu-speed)).

- Some DOS programs can _really_ freak out when the emulated CPU is being dynamically changed at runtime, which is what `max` tends to do.

All in all, `max` for protected mode is not a good default in 2024, so we've changed it to fixed 60,000 cycles, which is roughly equivalent to slow Pentium speeds. As protected mode games started appearing in the early to mid-90s, this should run the vast majority of them fairly optimally out-of-the-box.


### Config command paginate, better help help

### Configurable title bar

### Read-only mounting

Y drive

### IBM XDF support


??? note "Full PR list of miscellaneous enhancements"

    - Add IBM XDF floppy support (#3442)
    - Add carry, sign, zero, and parity flags to integer division instructions (#3785)
    - `CONFIG` command enhancements (#3667)
    - Config setting improvements and `CONFIG` command fixes (#3754)
    - Fix MMX crash on moralhardcandy (#3814)
    - Fix switch to dynamic core warning edge case (#3732)
    - Fix warning when using a high cycles value on a non-dynamic core (#3716)
    - Implement read-only mounting + make Y drive read-only by default (#3711)
    - Improve reset handler (#3696)
    - Improve the `core` and `cputype` setting descriptions (#3708)
    - Improve title bar and make it configurable (#3249)
    - Integrate MMX emulation (#3426)
    - Introduce a better way to set the CPU cycles with new defaults (#3681)
    - Make the Time Stamp Counter more realistic (#3471)
    - Move IPX server to a background thread (#3414)
    - Paginate the CONFIG command's output (#3758)
    - Show memory read breakpoint with BPLIST (#3396)


??? note "Full PR list of miscellaneous fixes"

    - Add DOS Files to shutdown step to avoid a crash when shutting down (#3801)
    - Allow running the `INTRO` built-in from subshells (#3665)
    - Avoid unnecessary new-lines (#3617)
    - `CONFIG -h` should only list visible setting values (#3753)
    - Fix 'output' and other 'sdl' settings not changeable in runtime (#3571)
    - Fix IPX ping value display (#3418)
    - Fix Reboot Handler crash (#3683)
    - Fix file open error in ISO Drive (#3804)
    - Make parameter addresses properly sized in ppc64le dynrec (fixes #3686) (#3718)
    - Use CreateFileW on Windows to create file in local_drive_create_file() (#3746)


??? note "Full PR list of documentation-related changes"

    - Add bisecting notes to build documentation (#3816)
    - Add comment about PPC64 big-endian and running 32-bit BE code (#3827)
    - Add warning about CMake support being experimental (#3790)
    - Clarify build instructions for low memory targets (#3658)
    - Create .clang-tidy (#3423)
    - Remove -usecd and -listcd MOUNT parameters from INTRO and the README (#3625)
    - Simple documentation fixes (#3782)
    - Update Windows build guide (#3424)

??? note "Full PR list of project maintenance related changes"

    - Add Debian package build scripts and workflow (#3809)
    - Advance vcpkg baseline to upgrade to SDL 2.30.0 (#3606)
    - Allow SDL wraps to be bypassed on macOS (#3483)
    - Audio cleanups (#3615)
    - Avoid the use of std::string_view::data() (#3542)
    - Basic CMake support (#3361)
    - Bump Coverity build from Clang 14 to Clang 15 (#3419)
    - Bump PVS Studio CI from Clang 14 to Clang 15 (#3437)
    - Bump vcpkg baseline and update to upstream libslirp v4.8.0 (#3761)
    - Callback code generation rework (#3748)
    - Change ppc64 to use correct `POWERPC` target (#3826)
    - Clean up macOS notarization script (#3408)
    - Cleanup a few warnings in cdrom_image.cpp (#3472)
    - Cleanup of using namespace (#3444)
    - Cleanup some missed C++ header conversions (#3412)
    - Create new cross compiler docker images and adjust workflows (#3678)
    - Do not auto-run DOSBox Staging after installing it on Windows (#3583)
    - Eliminate excessive repeat heap calls during normal runtime (#3812)
    - Fix CDROM_Interface pointer ownership issue (#3634)
    - Fix MSVC CI builds (#3474)
    - Fix compilation warnings reported by g++ 14.1 (#3783)
    - Fix issue with replace() (#3533)
    - Fix macOS CI workflow (#3505)
    - Fix sed creating backup files ending with "-e" in macOS bundle (#3406)
    - Fix some PVS warnings (#3484)
    - Fix variables optimizing away when debugging MSClang builds (#3397)
    - Fix vcredist version for MSVC CI runner (#3480)
    - Ignore meson.build in VS tests project (#3422)
    - Introduce custom release notes drafter script & workflow (#3398)
    - Make GCC 11 / Ubuntu 22.04 the minimum build target (#3674)
    - Mass update copyright dates (#3584)
    - Migrate to C++20 (#3286)
    - Minor FPU cleanup (#3837)
    - More PVS warning fixes (#3494)
    - Pin CMake version for MSVC runner (#3598)
    - Release drafter enhancements (#3546)
    - Remove Debian 10 support (#3534)
    - Remove GCC_LIKELY/GCC_UNLIKELY (#3293)
    - Search for numbered clang-format binaries in format-commit.sh (#3747)
    - Unicode API refactoring (#3797)
    - Unify use of prop->Set_values (#3572)
    - Update simde to 0.8.0 (#3522)
    - Update string_utils to use C++20 constructs (#3540)
    - Upgrade SIMDE to 0.8.2 (#3662)
    - Upgrade Windows CI setup-msbuild GitHub action (#3477)
    - Usage of integer types & disabling sign conversion warnings (#3631)
    - Use C++ system headers (#3284)
    - Use GitHub actions cache for vcpkg (#3503)
    - Use GitHub runners for macOS builds (#3384)


??? note "Full PR list of other changes"

    - Allow the PVS-Studio workflow run in forked PRs (#3493)
    - Build Windows package for the ARM64 platform (#3823)
    - Don't execute compile workflows on documentation and script changes (#3393)
    - Fix division regression by resetting flag type (#3795)
    - Fix fs_utils_tests for macOS and enable test runs on macOS CI (#3622)
    - Fix msys2 compilation error with cdrom_win32.cpp (#3676)
    - Introduce unittests for the Value class (#3369)
    - Remove hard-coded version string from MSVC CI (#3736)
    - Upgrade deprecated Node.js 16 GitHub actions to latest (#3457)
    - website: Add NixOS install instructions (#3479)


## Localisation

- Update Italian, Polish, Portugese, Spanish translations.
- TODO

??? note "Full PR list of localisation-related changes"

    - Avoid false positive warnings in translations (#3610)
    - Translations differ between platforms (#3579)
    - Update Polish (pl) translation, minor help string fix (#3850)
    - Update Polish (pl) translation, minor string fixes (#3684)
    - Update Portuguese Translation (#3609)
    - Update Spanish translation (#3624)
    - Update italian (it) translation (#3751)
    - Use uncompressed CPI files instead of compressed CPX ones (#3413)


## Contributors

The following commit authors, sponsors, supporters, and backers all invested
their time or funds into the 0.82 release effort. Thank you!

Contributors are listed in alphabetic order.

Thank you for considering supporting our work through a donation on
[GitHub Sponsors](https://github.com/sponsors/dosbox-staging) or
[Open Collective](https://opencollective.com/dosbox-staging). Your
contribution helps us purchase the necessary hardware and licenses to keep our
project going.


### 0.82 commit authors

<div class="compact" markdown>

- altiereslima
- Arcnor
- bluddy
- classilla
- dreamer
- farsil
- FeralChild64
- ftortoriello
- Grounded0
- interloper98
- japsmits
- johnnovak
- kcgen
- keenanweaver
- kklobe
- LowLevelMahn
- MeAreJeenius
- rderooy
- shermp
- stackErr-NameNotResolved
- strikersix23
- Torinde
- weirddan455

</div>


### 0.82 sponsors

<div class="compact" markdown>

- Antti Peltola

</div>

### 0.82 supporters

<div class="compact" markdown>

- Wengier Wu

</div>


### 0.82 backers

<div class="compact" markdown>

- TODO

</div>


## Thank you

We are grateful for all community contributions as well as the original DOSBox
project, upon which DOSBox Staging is based.

